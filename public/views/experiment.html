<!doctype html>
<html>
  <head>
    <title>Reaction times of auditory take over requests</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="jsPsych/jspsych.js"></script>
    <script src="jsPsych/plugins/jspsych-text.js"></script>
    <script src="jsPsych/plugins/jspsych-single-audio.js"></script>
    <link href="jsPsych/css/jspsych.css" rel="stylesheet" type="text/css"></link>
    <link href="css/experiment.css" rel="stylesheet" type="text/css"></link>
  </head>
  <body>
    <div class = "parent">
      <div class = "child">
        <div id="jspsych_target"></div>
      </div>
    </div>
  </body>
  <script>

  /* define instructions block */
  var instructions_block = {
    type: "text",
    text: "<p>In this experiment, you will hear sounds and see red circles. You need to press 'F' after hearing a sound OR seeing a red circle (whichever comes first) as fast as possible. Your reaction times will be recorded. You will be asked to respond to stimuli in blocks of 25. </p>",
    timing_post_trial: 2000
  };

  var post_trial_gap_last = -1;

  var post_trial_gap = function() {
    post_trial = Math.floor( Math.random() * 1000 ) + 1000;
    post_trial_gap_last = post_trial;
    return post_trial;
  }

  /* define test block */
  var test_stimuli = [
    /* red delayed*/
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_red_10ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_red_10"});
    	jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_red_60ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_red_60"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_red_70ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_red_70"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_red_80ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_red_80"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_red_90ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_red_90"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_red_100ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_red_100"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_red_200ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_red_200"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_red_300ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_red_300"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_red_500ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_red_500"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_red_1000ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_red_1000"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    /* middle red delayed */
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_middle_10ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_middle_10"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_middle_20ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_middle_20"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_middle_30ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_middle_30"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_middle_40ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_middle_40"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_middle_50ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_middle_50"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_middle_60ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_middle_60"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_middle_70ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_middle_70"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_middle_80ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_middle_80"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_middle_90ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_middle_90"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_middle_100ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_middle_100"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_middle_200ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_middle_200"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_middle_300ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_middle_300"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_middle_500ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_middle_500"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_middle_1000ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_middle_1000"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    /* low red delayed */
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_low_10ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_low_10"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_low_20ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_low_20"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_low_30ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_low_30"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_low_40ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_low_40"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_low_50ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_low_50"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_low_60ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_low_60"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_low_70ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_low_70"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_low_80ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_low_80"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_low_90ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_low_90"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_low_100ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_low_100"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_low_200ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_low_200"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_low_300ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_low_300"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_low_500ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_low_500"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_low_1000ms.gif" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_low_1000"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    /* red */
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_red.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_red"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_10ms.mp3',
      prompt: '<img src="img/circle_red.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_10_red"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_20ms.mp3',
      prompt: '<img src="img/circle_red.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_20_red"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_30ms.mp3',
      prompt: '<img src="img/circle_red.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_30_red"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_40ms.mp3',
      prompt: '<img src="img/circle_red.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_40_red"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_50ms.mp3',
      prompt: '<img src="img/circle_red.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_50_red"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_60ms.mp3',
      prompt: '<img src="img/circle_red.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_60_red"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_70ms.mp3',
      prompt: '<img src="img/circle_red.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_70_red"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_80ms.mp3',
      prompt: '<img src="img/circle_red.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_80_red"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_90ms.mp3',
      prompt: '<img src="img/circle_red.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_90_red"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_100ms.mp3',
      prompt: '<img src="img/circle_red.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_100_red"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_200ms.mp3',
      prompt: '<img src="img/circle_red.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_200_red"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_300ms.mp3',
      prompt: '<img src="img/circle_red.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_300_red"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_500ms.mp3',
      prompt: '<img src="img/circle_red.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_500_red"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_1000ms.mp3',
      prompt: '<img src="img/circle_red.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_1000_red"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    /* middle red */
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_middle.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_middle"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_10ms.mp3',
      prompt: '<img src="img/circle_middle.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_10_middle"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_20ms.mp3',
      prompt: '<img src="img/circle_middle.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_20_middle"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_30ms.mp3',
      prompt: '<img src="img/circle_middle.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_30_middle"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_40ms.mp3',
      prompt: '<img src="img/circle_middle.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_40_middle"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_50ms.mp3',
      prompt: '<img src="img/circle_middle.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_50_middle"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_60ms.mp3',
      prompt: '<img src="img/circle_middle.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_60_middle"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_70ms.mp3',
      prompt: '<img src="img/circle_middle.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_70_middle"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_80ms.mp3',
      prompt: '<img src="img/circle_middle.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_80_middle"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_90ms.mp3',
      prompt: '<img src="img/circle_middle.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_90_middle"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_100ms.mp3',
      prompt: '<img src="img/circle_middle.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_100_middle"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_200ms.mp3',
      prompt: '<img src="img/circle_middle.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_200_middle"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_300ms.mp3',
      prompt: '<img src="img/circle_middle.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_300_middle"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_500ms.mp3',
      prompt: '<img src="img/circle_middle.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_500_middle"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_1000ms.mp3',
      prompt: '<img src="img/circle_middle.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_1000_middle"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    /* low red */
    {
      stimulus: 'sounds/beep_0ms.mp3',
      prompt: '<img src="img/circle_low.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_low"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_10ms.mp3',
      prompt: '<img src="img/circle_low.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_10_low"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_20ms.mp3',
      prompt: '<img src="img/circle_low.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_20_low"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_30ms.mp3',
      prompt: '<img src="img/circle_low.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_30_low"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_40ms.mp3',
      prompt: '<img src="img/circle_low.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_40_low"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_50ms.mp3',
      prompt: '<img src="img/circle_low.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_50_low"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_60ms.mp3',
      prompt: '<img src="img/circle_low.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_60_low"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_70ms.mp3',
      prompt: '<img src="img/circle_low.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_70_low"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_80ms.mp3',
      prompt: '<img src="img/circle_low.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_80_low"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_90ms.mp3',
      prompt: '<img src="img/circle_low.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_90_low"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_100ms.mp3',
      prompt: '<img src="img/circle_low.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_100_low"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_200ms.mp3',
      prompt: '<img src="img/circle_low.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_200_low"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_300ms.mp3',
      prompt: '<img src="img/circle_low.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_300_low"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_500ms.mp3',
      prompt: '<img src="img/circle_low.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_500_low"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    {
      stimulus: 'sounds/beep_1000ms.mp3',
      prompt: '<img src="img/circle_low.png" />',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_1000_low"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    },
    /* no visual */
    {
      stimulus: 'sounds/beep_0ms.mp3',
      on_finish: function(data){
        jsPsych.data.addDataToLastTrial({type: "beep_0_no"});
        jsPsych.data.addDataToLastTrial({delay_after: post_trial_gap_last});
      }
    }
  ];

  // var all_trials = jsPsych.randomization.repeat(test_stimuli.slice(0,30), 1);
  var all_trials = jsPsych.randomization.repeat(test_stimuli, 2);

  var audio_block_1 = {
    type: 'single-audio',
    choices: ['F'],
    timing_post_trial: post_trial_gap,
    timeline: all_trials.slice(0,2),
  };
  var audio_block_2 = {
    type: 'single-audio',
    choices: ['F'],
    timing_post_trial: post_trial_gap,
    timeline: all_trials.slice(26,50),
  };
  var audio_block_3 = {
    type: 'single-audio',
    choices: ['F'],
    timing_post_trial: post_trial_gap,
    timeline: all_trials.slice(51,75),
  };
  var audio_block_4 = {
    type: 'single-audio',
    choices: ['F'],
    timing_post_trial: post_trial_gap,
    timeline: all_trials.slice(76,100),
  };
  var audio_block_5 = {
    type: 'single-audio',
    choices: ['F'],
    timing_post_trial: post_trial_gap,
    timeline: all_trials.slice(101,125),
  };
  var audio_block_6 = {
    type: 'single-audio',
    choices: ['F'],
    timing_post_trial: post_trial_gap,
    timeline: all_trials.slice(126,150),
  };
  var audio_block_7 = {
    type: 'single-audio',
    choices: ['F'],
    timing_post_trial: post_trial_gap,
    timeline: all_trials.slice(151),
  };

  var between_block_1 = {
    type: "text",
    cont_key: ['C'],
    text: function() {
      return "<p>You have now completed 25 stimuli out of 176. When ready press 'C' to proceed to the next batch.</p>";
    }
  };

  var between_block_2 = {
    type: "text",
    cont_key: ['C'],
    text: function() {
      return "<p>You have now completed 50 stimuli out of 176. When ready press 'C' to proceed to the next batch.</p>";
    }
  };

  var between_block_3 = {
    type: "text",
    cont_key: ['C'],
    text: function() {
      return "<p>You have now completed 75 stimuli out of 176. When ready press 'C' to proceed to the next batch.</p>";
    }
  };


var between_block_4 = {
    type: "text",
    cont_key: ['C'],
    text: function() {
      return "<p>You have now completed 100 stimuli out of 176. When ready press 'C' to proceed to the next batch.</p>";
    }
  };

  var between_block_5 = {
    type: "text",
    cont_key: ['C'],
    text: function() {
      return "<p>You have now completed 125 stimuli out of 176. When ready press 'C' to proceed to the next batch.</p>";
    }
  };

  var between_block_6 = {
    type: "text",
    cont_key: ['C'],
    text: function() {
      return "<p>You have now completed 150 stimuli out of 176. When ready press 'C' to proceed to the next batch.</p>";
    }
  };

  /* create experiment timeline array */
  var timeline = [];
  timeline.push(instructions_block);
  timeline.push(audio_block_1);
  // timeline.push(between_block_1);
  // timeline.push(audio_block_2);
  // timeline.push(between_block_2);
  // timeline.push(audio_block_3);
  // timeline.push(between_block_3);
  // timeline.push(audio_block_4);
  // timeline.push(between_block_4);
  // timeline.push(audio_block_5);
  // timeline.push(between_block_5);
  // timeline.push(audio_block_6);
  // timeline.push(between_block_6);
  // timeline.push(audio_block_7);

  var getUrlParameter = function getUrlParameter(sParam) {
    var sPageURL = decodeURIComponent(window.location.search.substring(1)),
        sURLVariables = sPageURL.split('&'),
        sParameterName,
        i;

    for (i = 0; i < sURLVariables.length; i++) {
        sParameterName = sURLVariables[i].split('=');

        if (sParameterName[0] === sParam) {
            return sParameterName[1] === undefined ? true : sParameterName[1];
        }
    }
  };

  /* MTurk information */
  var turkInfo = jsPsych.turk.turkInfo();
  if(turkInfo.previewMode && !turkInfo.outsideTurk) {
    worker_id = turkInfo.workerId;
  } else {
    worker_id = String(Date.now());
  }
  timestamp = String(Date.now());

  jsPsych.pluginAPI.preloadImages(['img/circle_red.png', 'img/circle_low.png', 'img/circle_middle.png', 'img/circle_red_10ms.gif', 'img/circle_red_20ms.gif', 'img/circle_red_30ms.gif', 'img/circle_red_40ms.gif', 'img/circle_red_50ms.gif', 'img/circle_red_60ms.gif', 'img/circle_red_70ms.gif', 'img/circle_red_80ms.gif', 'img/circle_red_90ms.gif', 'img/circle_red_100ms.gif', 'img/circle_red_200ms.gif', 'img/circle_red_300ms.gif', 'img/circle_red_500ms.gif', 'img/circle_red_1000ms.gif','img/circle_middle_10ms.gif', 'img/circle_middle_20ms.gif', 'img/circle_middle_30ms.gif', 'img/circle_middle_40ms.gif', 'img/circle_middle_50ms.gif', 'img/circle_middle_60ms.gif', 'img/circle_middle_70ms.gif', 'img/circle_middle_80ms.gif', 'img/circle_middle_90ms.gif', 'img/circle_middle_100ms.gif', 'img/circle_middle_200ms.gif', 'img/circle_middle_300ms.gif', 'img/circle_middle_500ms.gif', 'img/circle_middle_1000ms.gif','img/circle_low_10ms.gif', 'img/circle_low_20ms.gif', 'img/circle_low_30ms.gif', 'img/circle_low_40ms.gif', 'img/circle_low_50ms.gif', 'img/circle_low_60ms.gif', 'img/circle_low_70ms.gif', 'img/circle_low_80ms.gif', 'img/circle_low_90ms.gif', 'img/circle_low_100ms.gif', 'img/circle_low_200ms.gif', 'img/circle_low_300ms.gif', 'img/circle_low_500ms.gif', 'img/circle_low_1000ms.gif'], function(){ preloadAudio(); });

  function preloadAudio () {
      jsPsych.pluginAPI.preloadAudioFiles(['sounds/beep_0ms.mp3', 'sounds/beep_10ms.mp3', 'sounds/beep_20ms.mp3', 'sounds/beep_30ms.mp3', 'sounds/beep_40ms.mp3', 'sounds/beep_50ms.mp3', 'sounds/beep_60ms.mp3', 'sounds/beep_70ms.mp3', 'sounds/beep_80ms.mp3', 'sounds/beep_90ms.mp3', 'sounds/beep_100ms.mp3', 'sounds/beep_200ms.mp3', 'sounds/beep_300ms.mp3', 'sounds/beep_500ms.mp3', 'sounds/beep_1000ms.mp3'], start);
  }

  /* Start the experiment */
    function start(){
      jsPsych.init({
        display_element: $('#jspsych_target'),
        // show_progress_bar: true,
        timeline: timeline,
        on_finish: function() {
          jsPsych.data.addDataToLastTrial({'work': getUrlParameter('work')});
          $.ajax({
            type: "POST",
            url: "/experiment-data",
            data: JSON.stringify(jsPsych.data.getData()),
            contentType: "application/json"
          })
          .done(function() {
            window.location.href = "finish?work=" + getUrlParameter('work');
          })
          .fail(function() {
            alert("A problem occurred while writing to the database. Please contact the researcher for more information.")
            window.location.href = "/";
          })
        }
      });
    }

</script>
</html>